checks:
  # ============================================
  # Provider-level default_tags checks (MoJ pattern)
  # ============================================

  # Check AWS provider has default_tags with business-unit
  - code: MOJ001
    description: Ensure AWS provider has 'business-unit' in default_tags
    impact: Resources without business-unit tag cannot be attributed to a department for cost allocation
    resolution: "Add 'business-unit' to provider default_tags (valid values: CICA, Central Digital, HMCTS, HMPPS, HQ, LAA, OPG, Platforms, Technology Services, YJB)"
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: business-unit
    errorMessage: AWS provider missing 'business-unit' in default_tags. Add it with a valid business unit.
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html

  # Check AWS provider has default_tags with application
  - code: MOJ002
    description: Ensure AWS provider has 'application' in default_tags
    impact: Resources without application tag cannot be linked to a specific service
    resolution: Add 'application' to provider default_tags with your service/application name
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: application
    errorMessage: AWS provider missing 'application' in default_tags.
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html

  # Check AWS provider has default_tags with owner
  - code: MOJ003
    description: Ensure AWS provider has 'owner' in default_tags
    impact: Resources without owner tag have no accountable team for maintenance and costs
    resolution: Add 'owner' to provider default_tags (team name or team-name:email format)
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: owner
    errorMessage: AWS provider missing 'owner' in default_tags.
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html

  # Check AWS provider has default_tags with is-production
  - code: MOJ004
    description: Ensure AWS provider has 'is-production' in default_tags
    impact: Cannot determine production status for prioritization and cost analysis
    resolution: Add 'is-production' to provider default_tags with value 'true' or 'false'
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: is-production
    errorMessage: AWS provider missing 'is-production' in default_tags. Value must be 'true' or 'false'.
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html

  # Check AWS provider has default_tags with namespace
  - code: MOJ005
    description: Ensure AWS provider has 'namespace' in default_tags
    impact: Resources cannot be linked to their Kubernetes namespace
    resolution: Add 'namespace' to provider default_tags
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: namespace
    errorMessage: AWS provider missing 'namespace' in default_tags.
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html

  # Check AWS provider has default_tags with service-area
  - code: MOJ006
    description: Ensure AWS provider has 'service-area' in default_tags
    impact: Resources cannot be grouped by service area for reporting
    resolution: Add 'service-area' to provider default_tags
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: service-area
    errorMessage: AWS provider missing 'service-area' in default_tags.
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html

  # Check AWS provider has default_tags with environment
  - code: MOJ007
    description: Ensure AWS provider has 'environment' in default_tags
    impact: Cannot distinguish between production, staging, test, and development resources
    resolution: "Add 'environment' to provider default_tags (valid values: staging, production, development, test)"
    requiredTypes:
      - provider
    requiredLabels:
      - aws
    severity: ERROR
    matchSpec:
      name: default_tags
      action: isPresent
      subMatch:
        name: tags
        action: contains
        value: environment
    errorMessage: "AWS provider missing 'environment' in default_tags. Value must be: staging, production, development, or test."
    relatedLinks:
      - https://cloud-optimisation-and-accountability.justice.gov.uk/documentation/finops-and-greenops-at-moj/standards/tagging.html
